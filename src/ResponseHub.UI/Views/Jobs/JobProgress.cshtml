@model Enivate.ResponseHub.UI.Models.Messages.JobMessageViewModel

<h3>Job progress</h3>

<div class="row">
	<div class="col-lg-8 progess-messages"></div>
</div>

<div class="row">
	<div class="col-xs-12 col-sm-4 col-md-3 col-lg-3 col-xl-2 progress-action">
		@if (Model.OnRoute == null && Model.Cancelled == null)
		{
			<button class="btn btn-primary btn-icon btn-block btn-lg btn-on-route"><i class="fa fa-fw fa-check-square-o"></i> On route</button>
		}
		<div class="progress-time progress-on-route">
			@if (Model.OnRoute != null)
			{
				<h4>On route</h4>
				<div class="btn-icon"><i class="fa fa-fw fa-clock-o"></i>@Model.OnRoute.Timestamp.ToString("yyyy-MM-dd HH:mm")</div>
				<div class="text-muted btn-icon"><i class="fa fa-fw fa-user"></i>@Model.OnRoute.UserFullName</div>
			}
		</div>
	</div>
	<div class="col-xs-12 col-sm-4 col-md-3 col-md-offset-1 col-lg-3 col-xl-2 progress-action">
		@if (Model.OnScene == null && Model.Cancelled == null)
		{
			<button class="btn btn-primary btn-icon btn-block btn-lg btn-on-scene"><i class="fa fa-fw fa-check-square-o"></i> On scene</button>
		}
		<div class="progress-time progress-on-scene">
			@if (Model.OnScene != null)
			{
				<h4>On scene</h4>
				<div class="btn-icon"><i class="fa fa-fw fa-clock-o"></i>@Model.OnScene.Timestamp.ToString("yyyy-MM-dd HH:mm")</div>
				<div class="text-muted btn-icon"><i class="fa fa-fw fa-user"></i>@Model.OnScene.UserFullName</div>
			}
		</div>
	</div>
	<div class="col-xs-12 col-sm-4 col-md-3 col-md-offset-1 col-lg-3 col-xl-2 progress-action">
		@if (Model.JobClear == null && Model.Cancelled == null)
		{
			<button class="btn btn-primary btn-icon btn-block btn-lg btn-job-clear"><i class="fa fa-fw fa-check-square-o"></i> Job clear</button>
		}
		<div class="progress-time progress-job-clear">
			@if (Model.JobClear != null)
			{
				<h4>Job clear</h4>
				<div class="btn-icon"><i class="fa fa-fw fa-clock-o"></i>@Model.JobClear.Timestamp.ToString("yyyy-MM-dd HH:mm")</div>
				<div class="text-muted btn-icon"><i class="fa fa-fw fa-user"></i>@Model.JobClear.UserFullName</div>
			}
		</div>
	</div>
</div>

<div class="row">
	<div class="col-xs-12">
		@if (Model.Cancelled == null && Model.JobClear == null)
		{
			<p class="top-10"><a href="#" class="btn-icon text-danger" data-toggle="modal" data-target="#confirm-cancel-job"><i class="fa fa-fw fa-times"></i>Cancel job</a></p>
		}
		else if (Model.Cancelled != null)
		{
			<p class="text-danger top-10">Job cancelled on @Model.Cancelled.Timestamp.ToString("dd/MM/yyyy HH:mm") by @Model.Cancelled.UserFullName.</p>
		}
	</div>
</div>

<div class="modal fade" id="confirm-cancel-job" tabindex="-1" role="dialog" aria-labelledby="confirm-cancel-label">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="confirm-cancel-label">Cancel job?</h4>
			</div>
			<div class="modal-body">
				<p>Are you sure you wish to cancel this job? Once a job is cancelled, no further progress updates can be made.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
				<a href="/jobs/@Model.Id/cancel-job" class="btn btn-danger">Cancel job</a>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->